<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../static/bootstrap/css/bootstrap.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="../static/home.css">
    <link rel="icon" type="image/x-icon" href="../static/img/icon.png">
    <title>Pizzaria - Delivery</title>
</head>

<body>
    <header>
        <nav class="navbar navbar-dark">
            <a class="navbar-brand" href="/home">
                <img id="logo" src="../static/img/logo.png" class="d-inline-block align-center" alt="">
                Pizzaria
            </a>
            <ul class="nav justify-content-end">
                <li class="nav-item">
                    <a class="nav-link active" href="#" target="_blank"><img id="navicon"
                            src="../static/img/whatsapp.gif"></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link active" href="#" target="_blank"><img id="navicon"
                            src="../static/img/instagram.gif"></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link active" href="#" target="_blank"><img id="navicon"
                            src="../static/img/facebook.gif"></a>
                </li>
            </ul>
        </nav>
    </header>

    <main>
        <div class="container-head">
            <div class="head"><strong>Faça já o seu pedido!</strong>
            </div>
        </div>

        <div class="accordion">
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                        data-bs-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
                        Pizza Grande - 1 Sabor (8 Fatias)
                    </button>
                </h2>
                <div id="collapseOne" class="accordion-collapse collapse">
                    <div class="accordion-body">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th class="text-center">#</th>
                                    <th>Pizza</th>
                                    <th class="text-center">Preço</th>
                                    <th class="text-center"></th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for pizza in pizzas %}
                                <tr>
                                    <td class="text-center">{{ pizza[0] }}</td>
                                    <td class="text-start">{{ pizza[1] }}
                                        <div class="info text-start">{{ pizza[2] }}</div>
                                    </td>
                                    <td class="text-center">R$ {{ "%.2f" % pizza[3] }}
                                    </td>
                                    <form action="{{ url_for('routes.add_carrinho', produto_id=pizza[0]) }}"
                                        method="post">
                                        <td class="text-center"><button class="btn btn-primary btn-sm"><i
                                                    class="bi bi-cart-plus"></i></button></td>
                                    </form>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                        data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                        Pizza Grande - 2 Sabores (8 Fatias)
                    </button>
                </h2>
                <div id="collapseTwo" class="accordion-collapse collapse">
                    <div class="accordion-body">
                        <form method="post">
                            <p><em>* Será cobrado a média do valor entre as escolhas</em></p>
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th class="text-center">#</th>
                                        <th>Pizza</th>
                                        <th class="text-center">Preço</th>
                                        <th class="text-center"></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for pizza in pizzas %}
                                    <tr>
                                        <td class="text-center">{{ pizza[0] }}</td>
                                        <td class="text-start">{{ pizza[1] }}
                                            <div class="info text-start">{{ pizza[2] }}</div>
                                        </td>
                                        <td class="text-center">R$ {{ "%.2f" % pizza[3] }}
                                        </td>
                                        <td class="text-center">
                                            <div>
                                                <input class="form-check-input" name="meioameio" type="checkbox"
                                                    id="{{ pizza[0] }}" value="{{ pizza[0] }}" required>
                                            </div>
                                        </td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                            <div class="text-center"><button class="btn btn-primary btn-sm" id="btn-finalizar">Adicionar
                                    ao
                                    Carrinho</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                        data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                        Porções
                    </button>
                </h2>
                <div id="collapseThree" class="accordion-collapse collapse">
                    <div class="accordion-body">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th class="text-center"></th>
                                    <th>Porção</th>
                                    <th class="text-center">Preço</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for porcao in porcoes %}
                                <tr>
                                    <td class="text-center"></td>
                                    <td class="text-start">{{ porcao[1] }}
                                        <div class="info text-start">{{ porcao[2] }}</div>
                                    </td>
                                    <td class="text-center">R$ {{ "%.2f" % porcao[3] }}
                                    </td>
                                    <form action="{{ url_for('routes.add_carrinho', produto_id=porcao[0]) }}"
                                        method="post">
                                        <td class="text-center"><button class="btn btn-primary btn-sm"><i
                                                    class="bi bi-cart-plus"></i></button></td>
                                    </form>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                        data-bs-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
                        Bebidas
                    </button>
                </h2>
                <div id="collapseFour" class="accordion-collapse collapse">
                    <div class="accordion-body">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th class="text-center"></th>
                                    <th>Bebida</th>
                                    <th class="text-center">Preço</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for bebida in bebidas %}
                                <tr>
                                    <td class="text-center"></td>
                                    <td class="text-start">{{ bebida[1] }}
                                        <div class="info text-start">{{ bebida[2] }}</div>
                                    </td>
                                    <td class="text-center">R$ {{ "%.2f" % bebida[3] }}
                                    </td>
                                    <form action="{{ url_for('routes.add_carrinho', produto_id=bebida[0]) }}"
                                        method="post">
                                        <td class="text-center"><button class="btn btn-primary btn-sm"><i
                                                    class="bi bi-cart-plus"></i></button></td>
                                    </form>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <div class="container" id="carrinhoContainer">
        {% set total_carrinho = models.calcular_total_carrinho() %}
        {% if session.get('cart') or session.get('meioameio') %}
        <div class="text-center"><img src="..//static/img/anime.gif" id="emoji"> Seu Carrinho:</div>
        <table class="table-borderless">
            <thead>
                <th></th>
                <th></th>
            </thead>
            <tbody>
                <tr>
                    <td class="text-start"><strong>Total no Carrinho:</strong> R$ {{ '%.2f' % total_carrinho }}</td>
                    <td>
                        <div class="text-end">
                            <button id="toggleCarrinhoBtn" class="btn btn-primary btn-sm"><i
                                    class="bi bi-arrows-angle-expand"></i></button>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
        <div class="carrinho-conteudo fechado" id="carrinhoConteudo">
            <table class="table-borderless table-sm">
                <thead>
                    <th>Itens:</th>
                    <th>Preço:</th>
                    <th class="text-start"></th>
                </thead>
                <tbody>
                    {% for produto_id in session['cart'] %}
                    {% set produto = models.buscar_produto(produto_id) %}
                    <tr id="produto_cart">
                        <td class="text-start">{{ produto[1] }}</td>
                        <td>R$ {{ '%.2f' % produto[2] }}</td>
                        <form action="{{ url_for('routes.remover_carrinho', produto_id=produto[0]) }}" method="post">
                            <td class="text-start"><button class="btn btn-danger btn-sm"
                                    style="background-color: darkred;"><i class="bi bi-trash"></i></button>
                            </td>
                        </form>
                    </tr>
                    {% endfor %}

                    {% for meioameio in session['meioameio'] %}
                    {% set id_pizza1 = meioameio[0] %}
                    {% set id_pizza2 = meioameio[1] %}
                    {% set meio_a_meio = models.buscar_meioameio(id_pizza1, id_pizza2) %}
                    <tr id="produto_cart">
                        <td class="text-start">
                            {{ meio_a_meio[0] }}
                        </td>
                        <td>R$ {{ "%.2f" % meio_a_meio[1] }}</td>
                        <form action="{{ url_for('routes.remover_meioameio', index=loop.index0) }}" method="post">
                            <td class="text-start">
                                <button type="submit" class="btn btn-danger btn-sm"
                                    style="background-color: darkred;"><i class="bi bi-trash"></i></button>
                            </td>
                        </form>
                    </tr>
                    {% endfor %}

                </tbody>
            </table>
            <form action="{{ url_for('routes.pedido') }}">
                <div class="text-center"><button class="btn btn-primary btn-sm" id="btn-finalizar">Finalizar
                        Pedido</button>
                </div>
            </form>
        </div>
        {% else %}
        <!-- Se o carrinho estiver vazio, mostre uma mensagem -->
        <p>Seu carrinho está vazio. <img src="..//static/img/sad.gif" id="emoji"></p>
        {% endif %}
    </div>

    <script src="../static/home-script.js"></script>
    <script src="../static/bootstrap/js/bootstrap.bundle.min.js"></script>
</body>

</html>